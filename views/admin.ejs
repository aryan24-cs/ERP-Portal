<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ERP Portal - Admin Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
      }
      .tab-button.active {
        background-color: #2563eb;
        color: white;
      }
      .hidden {
        display: none;
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <header
      class="bg-gradient-to-r from-blue-600 to-blue-800 text-white shadow-lg"
    >
      <div
        class="container mx-auto px-4 py-4 flex justify-between items-center"
      >
        <h1 class="text-2xl font-bold">Admin Dashboard</h1>
        <nav>
          <a
            href="/"
            class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition"
            >Logout</a
          >
        </nav>
      </div>
    </header>
    <main class="container mx-auto px-4 py-8 fade-in">
      <% if (error) { %>
      <p class="text-red-500 text-center mb-4"><%= error %></p>
      <% } %>
      <div class="bg-white rounded-lg shadow-lg p-6">
        <div class="flex space-x-4 mb-6">
          <button
            class="tab-button px-4 py-2 rounded-lg bg-gray-200 hover:bg-blue-600 hover:text-white transition"
            data-tab="create-user"
          >
            Create User
          </button>
          <button
            class="tab-button px-4 py-2 rounded-lg bg-gray-200 hover:bg-blue-600 hover:text-white transition"
            data-tab="edit-user"
          >
            Edit User
          </button>
          <button
            class="tab-button px-4 py-2 rounded-lg bg-gray-200 hover:bg-blue-600 hover:text-white transition"
            data-tab="upload-documents"
          >
            Upload Documents
          </button>
          <button
            class="tab-button px-4 py-2 rounded-lg bg-gray-200 hover:bg-blue-600 hover:text-white transition"
            data-tab="make-attendance"
          >
            Make Attendance
          </button>
        </div>
        <div id="create-user" class="tab-content">
          <h2 class="text-xl font-semibold mb-4">Create User</h2>
          <form action="/admin/create-user" method="POST" class="space-y-4">
            <input type="hidden" name="token" value="<%= token %>" />
            <input
              type="text"
              name="name"
              placeholder="Name"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="email"
              name="email"
              placeholder="Email"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="rollNo"
              placeholder="Roll No"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="class"
              placeholder="Class"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="phone"
              placeholder="Phone"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="date"
              name="dob"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="fatherName"
              placeholder="Father's Name"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="motherName"
              placeholder="Mother's Name"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="address"
              placeholder="Address"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
            >
              Create User
            </button>
          </form>
        </div>
        <div id="edit-user" class="tab-content hidden">
          <h2 class="text-xl font-semibold mb-4">Edit User</h2>
          <form action="/admin/edit-user" method="POST" class="space-y-4">
            <input type="hidden" name="token" value="<%= token %>" />
            <select
              name="userId"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            >
              <option value="">Select User</option>
              <% users.forEach(user => { %>
              <option value="<%= user._id %>">
                <%= user.name %> (<%= user.email %>)
              </option>
              <% }) %>
            </select>
            <input
              type="text"
              name="name"
              placeholder="Name"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="rollNo"
              placeholder="Roll No"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="class"
              placeholder="Class"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="phone"
              placeholder="Phone"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="date"
              name="dob"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="fatherName"
              placeholder="Father's Name"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="motherName"
              placeholder="Mother's Name"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <input
              type="text"
              name="address"
              placeholder="Address"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
            >
              Update User
            </button>
          </form>
        </div>
        <div id="upload-documents" class="tab-content hidden">
          <h2 class="text-xl font-semibold mb-4">Upload Document</h2>
          <form
            action="/admin/upload"
            method="POST"
            enctype="multipart/form-data"
            class="space-y-4"
          >
            <input type="hidden" name="token" value="<%= token %>" />
            <select
              name="userId"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            >
              <option value="">Select User</option>
              <% users.forEach(user => { %>
              <option value="<%= user._id %>">
                <%= user.name %> (<%= user.email %>)
              </option>
              <% }) %>
            </select>
            <select
              name="fileType"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            >
              <option value="idCard">ID Card</option>
              <option value="admitCard">Admit Card</option>
              <option value="marksheet">Marksheet</option>
            </select>
            <input
              type="file"
              name="file"
              accept=".jpg,.png,.pdf"
              required
              class="w-full px-4 py-2 border rounded-lg"
            />
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
            >
              Upload
            </button>
          </form>
        </div>
        <div id="make-attendance" class="tab-content hidden">
          <h2 class="text-xl font-semibold mb-4">Make Attendance</h2>
          <form action="/admin/mark-attendance" method="POST" class="space-y-4">
            <input type="hidden" name="token" value="<%= token %>" />
            <select
              name="userId"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            >
              <option value="">Select User</option>
              <% users.forEach(user => { %>
              <option value="<%= user._id %>">
                <%= user.name %> (<%= user.email %>)
              </option>
              <% }) %>
            </select>
            <input
              type="date"
              name="date"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            />
            <select
              name="status"
              required
              class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
            >
              <option value="Present">Present</option>
              <option value="Absent">Absent</option>
            </select>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
            >
              Mark Attendance
            </button>
          </form>
        </div>
      </div>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tabButtons = document.querySelectorAll(".tab-button");
        const tabContents = document.querySelectorAll(".tab-content");

        tabButtons.forEach((button) => {
          button.addEventListener("click", () => {
            tabButtons.forEach((btn) => btn.classList.remove("active"));
            tabContents.forEach((content) => content.classList.add("hidden"));

            button.classList.add("active");
            const tabId = button.getAttribute("data-tab");
            document.getElementById(tabId).classList.remove("hidden");
          });
        });

        // Show the first tab by default
        tabButtons[0].classList.add("active");
        tabContents[0].classList.remove("hidden");

        // Form validation
        const forms = document.querySelectorAll("form");
        forms.forEach((form) => {
          form.addEventListener("submit", (e) => {
            const inputs = form.querySelectorAll(
              "input[required], select[required]"
            );
            let valid = true;
            inputs.forEach((input) => {
              if (!input.value.trim()) {
                valid = false;
                input.classList.add("border-red-500");
              } else {
                input.classList.remove("border-red-500");
              }
            });
            if (!valid) {
              e.preventDefault();
              alert("Please fill all required fields.");
              return;
            }
            const button = form.querySelector('button[type="submit"]');
            button.disabled = true;
            button.textContent = "Processing...";
          });
        });
      });
    </script>
  </body>
</html>
